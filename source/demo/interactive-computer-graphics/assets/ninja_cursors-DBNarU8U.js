import"./modulepreload-polyfill-B5Qt9EMX.js";class ${constructor(){this.simpleTarget=!0,this.clickEffect=!0,this.targetCached=!0,this.cursorQueued=!0,this.drawPixels=!1,this.drawLayers=!1,this.sameSize=!0}}function W(l){const e=new Image;return e.src=l,e}const B={active:W("/res/cur_active.png"),wait:W("/res/cur_wait.png"),normal:W("/res/cur_normal.png")};class Z{constructor(){this.x=0,this.y=0,this.energy=0,this.tolerance=0,this.target=null}draw(e,t){this.energy>0&&this.drawShield(e,t),this.tolerance>0?this.drawBubble(e,t):this.drawNormal(e,t)}drawNormal(e,t){let i;t.isActiveCursor(this)?i=B.active:t.getNumberOfActiveCursors()>1||this.energy>0?i=B.wait:i=B.normal;const r=Math.round(this.x),s=Math.round(this.y);i.complete&&i.naturalWidth>0?e.drawImage(i,r,s):this.drawArrow(e,t,r,s)}drawArrow(e,t,i,r){const s=t.isActiveCursor(this),n=t.getNumberOfActiveCursors()>1||this.energy>0,u=s?"#00CC00":n?"#CC8800":"#888888";e.save(),e.translate(i,r),e.beginPath(),e.moveTo(0,0),e.lineTo(0,14),e.lineTo(3,10),e.lineTo(6,16),e.lineTo(9,15),e.lineTo(6,9),e.lineTo(10,9),e.closePath(),e.fillStyle=u,e.fill(),e.strokeStyle="#000",e.lineWidth=1,e.stroke(),e.restore()}drawBubble(e,t){const i=t.isActiveCursor(this),r=t.getNumberOfActiveCursors()>1||this.energy>0;let s,n;i?(s="rgba(0, 102, 204, 0.4)",n="#0000C0"):r?(s="rgba(204, 102, 0, 0.4)",n="#C06600"):(s="rgba(100, 100, 100, 0.4)",n="#808080");const u=Math.round(this.tolerance),a=Math.round(this.x),g=Math.round(this.y);e.beginPath(),e.arc(a,g,u,0,Math.PI*2),e.fillStyle=s,e.fill(),e.strokeStyle=n,e.lineWidth=2,e.beginPath(),e.moveTo(a-4,g),e.lineTo(a+4,g),e.moveTo(a,g-4),e.lineTo(a,g+4),e.stroke()}drawShield(e,t){const i=this.target,r=t.getSingleActiveCursor();if(!r||!i||!r.getTarget())return;const s=t.getCursors(),n=this.getQueueIndex(s)/s.length*2;if(n<=0)return;const a=Math.atan2(this.y-i.getY(),this.x-i.getX())*180/Math.PI,g=i.getRadius(),c=-(a-n*90),h=-(n*180),d=-c*Math.PI/180,w=-(c+h)*Math.PI/180,T=h>=0;e.beginPath(),e.arc(i.getX(),i.getY(),g+2,d,w,T),e.strokeStyle="rgba(128, 255, 0, 0.6)",e.lineWidth=4,e.stroke()}getQueueIndex(e){if(this.energy<=0)return 0;let t=1;for(const i of e){if(i===this)return t;i.energy>0&&t++}return t}moveTo(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}getEnergy(){return this.energy}setEnergy(e){this.energy=e}increaseEnergy(){this.energy+=1}getTolerance(){return this.tolerance}setTolerance(e){this.tolerance=e}getTarget(){return this.target}setTarget(e){this.target=e}}class x{constructor(){this.locationX=0,this.locationY=0,this.offsetX=0,this.offsetY=0,this.cursor=null}draw(e,t,i,r){t.getPreferences().drawPixels&&(e.fillStyle="rgba(0, 0, 0, 0.5)",e.fillRect(this.getX()-2,this.getY()-2,5,5))}offset(e,t){this.offsetX=e,this.offsetY=t}isLazy(){return this.offsetX!==0||this.offsetY!==0}moveTo(e,t){this.locationX=e,this.locationY=t}getX(){return this.locationX+this.offsetX}getY(){return this.locationY+this.offsetY}getOriginalX(){return this.locationX}getOriginalY(){return this.locationY}isPointed(e){return e.some(t=>t.getTarget()===this)}}const ee="rgba(128,128,128,0.5)",te="#C0C0C0",se="rgba(64,160,0,0.5)",re="#40A000",ie="rgba(192,64,64,0.5)",oe="#C04040",ne="rgba(64,64,192,0.5)",ae="#4040C0";function G(l,e,t,i,r,s){const n=Math.min(s,i/2,r/2);l.beginPath(),l.moveTo(e+n,t),l.lineTo(e+i-n,t),l.quadraticCurveTo(e+i,t,e+i,t+n),l.lineTo(e+i,t+r-n),l.quadraticCurveTo(e+i,t+r,e+i-n,t+r),l.lineTo(e+n,t+r),l.quadraticCurveTo(e,t+r,e,t+r-n),l.lineTo(e,t+n),l.quadraticCurveTo(e,t,e+n,t),l.closePath()}class le extends x{constructor(){super(...arguments),this.radius=24,this.type=Math.random()<.5?"folder":"file"}contains(e,t,i){if(i&&!this.isLazy())return!1;const r=e-this.getX(),s=t-this.getY();return r*r+s*s<this.radius*this.radius}draw(e,t,i,r){const s=this.isPointed(t.getCursors()),n=t.getNumberOfActiveCursors()>1,u=t.getGoalTarget();let a,g;u===this?(a=ne,g=ae):!i&&s?(a=se,g=re):n?(a=ie,g=oe):(a=ee,g=te);const c=this.getX(),h=this.getY(),d=this.radius;e.beginPath(),e.arc(c,h,d,0,Math.PI*2),e.fillStyle=a,e.fill(),e.strokeStyle=g,e.lineWidth=2,e.stroke(),this.type==="folder"?this.drawFolder(e,c,h,d):this.drawFile(e,c,h,d),super.draw(e,t,i,r)}drawFolder(e,t,i,r){const s=r*1.1,n=r*.65,u=r*.22,a=s*.42,g=r*.08,c=t-s/2,h=i-(u+n)/2;e.fillStyle="rgba(255,255,255,0.85)",G(e,c,h,a,u+g,g),e.fill(),G(e,c,h+u,s,n,g),e.fill()}drawFile(e,t,i,r){const s=r*.72,n=r*.9,u=r*.24,a=t-s/2,g=t+s/2,c=i-n/2,h=i+n/2;e.fillStyle="rgba(255,255,255,0.85)",e.beginPath(),e.moveTo(a,c),e.lineTo(g-u,c),e.lineTo(g,c+u),e.lineTo(g,h),e.lineTo(a,h),e.closePath(),e.fill(),e.fillStyle="rgba(180,180,180,0.7)",e.beginPath(),e.moveTo(g-u,c),e.lineTo(g,c+u),e.lineTo(g-u,c+u),e.closePath(),e.fill(),e.strokeStyle="rgba(140,140,140,0.8)",e.lineWidth=Math.max(1,r*.05);const d=a+s*.15,w=g-s*.12,T=c+n*.42;for(let C=0;C<3;C++)e.beginPath(),e.moveTo(d,T+C*r*.19),e.lineTo(w,T+C*r*.19),e.stroke()}getRadius(){return this.radius}setRadius(e){this.radius=e}}class ue{constructor(e,t){this.cursors=[],this.targets=[],this.activeCursors=new Set,this.clientWidth=800,this.clientHeight=600,this.goalTarget=null,this.dragTarget=null,this.lazySelect=!1,this.cursorNX=2,this.cursorNY=2,this.targetSize=112,this.targetDensity=.333,this.origin=null,this.cursorManager=e,this.prefs=t}getPreferences(){return this.prefs}getCursors(){return this.cursors}getTargets(){return this.targets}addTarget(e){this.targets.push(e)}removeTarget(e){this.targets=this.targets.filter(t=>t!==e)}setBounds(e,t){this.clientWidth=e,this.clientHeight=t}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}resetCursors(){this.setNumberOfCursors(this.cursorNX,this.cursorNY)}resetTargets(){this.setDensityOfTargets(this.targetDensity)}setNumberOfCursors(e,t){if(e<=0||t<=0)throw new Error("Invalid cursor count");e*t>1&&this.cursors.length===1?this.origin={x:this.cursors[0].getX(),y:this.cursors[0].getY()}:this.origin=null;const i=[],r=this.clientWidth/e,s=this.clientHeight/t;for(let n=0;n<t;n++)for(let u=0;u<e;u++){const a=new Z;a.moveTo(r/2+r*u,s/2+s*n),i.push(a)}this.updateActiveCursors([]),this.goalTarget=null,this.cursorNX=e,this.cursorNY=t,this.cursors=i}setDensityOfTargets(e){const t=[],i=Math.floor(this.targetSize*3/2),r=Math.floor(this.targetSize*3/2),s=Math.floor(this.clientWidth/i),n=Math.floor(this.clientHeight/r);for(let u=0;u<n;u++)for(let a=0;a<s;a++)if(Math.random()<=e){const g=new le,c=Math.floor(this.targetSize/2),h=i*a+Math.floor(i/2),d=r*u+Math.floor(r/2);g.moveTo(h,d),g.setRadius(c),t.push(g)}this.updateActiveCursors([]),this.goalTarget=null,this.targetDensity=e,this.targets=t}moveBy(e,t){this.cursors.length>1&&this.cursors.sort((i,r)=>this.isActiveCursor(i)?-1:this.isActiveCursor(r)?1:r.getEnergy()-i.getEnergy()),(e!==0||t!==0)&&this.cursorManager.moveBy(this,e,t)}getActiveCursors(){return new Set(this.activeCursors)}addActiveCursor(e){this.activeCursors.add(e)}removeActiveCursor(e){this.activeCursors.delete(e)}isActiveCursor(e){return this.activeCursors.has(e)}getNumberOfActiveCursors(){return this.activeCursors.size}getSingleActiveCursor(){return this.activeCursors.size===1?this.activeCursors.values().next().value??null:null}updateActiveCursors(e){this.activeCursors.clear();for(const t of e)this.activeCursors.add(t)}getGoalTarget(){return this.goalTarget}setGoalTarget(e){e!==null&&(this.targets=this.targets.filter(t=>t!==e),this.targets.push(e)),this.goalTarget=e}getDragTarget(){return this.dragTarget}setDragTarget(e){this.dragTarget=e}isMultiSelectionMode(){return!this.prefs.cursorQueued}isLazySelect(){return this.lazySelect}setLazySelect(e){this.lazySelect=e,this.initLazySelect()}initLazySelect(){for(const i of this.targets)i.offset(0,0);if(!this.lazySelect)return;const e=this.getNumberOfActiveCursors();let t=0;for(const i of this.activeCursors){const r=i.getTarget();if(!r)continue;const s=2*Math.PI*t++/e,n=Math.round(i.getX()-r.getX()+Math.cos(s)*r.getRadius()),u=Math.round(i.getY()-r.getY()+Math.sin(s)*r.getRadius());r.offset(n,u)}}setCursorManager(e){this.cursorManager=e}getCursorManager(){return this.cursorManager}}class D{moveBy(e,t,i){const r=e.getClientWidth(),s=e.getClientHeight(),n=e.getActiveCursors(),u=Array.from(n);let a=u.length>0?u[0]:null;const g=e.getCursors().length===1;e.updateActiveCursors([]);for(const c of e.getCursors()){let h=c.getX()+t,d=c.getY()+i;g?(h=Math.max(0,Math.min(r,h)),d=Math.max(0,Math.min(s,d))):(h<0&&(h=r+h),d<0&&(d=s+d),h>r&&(h=h-r),d>s&&(d=d-s));const w=this.getTargetAt(e,h,d);c.setTarget(w),c.setTolerance(0),e.isMultiSelectionMode()?(c.moveTo(h,d),c.setEnergy(0),w!==null&&e.addActiveCursor(c)):a===null?(w!==null&&(a=c),c.moveTo(h,d),c.setEnergy(0)):c===a?(w===null&&(a=null),c.moveTo(h,d),c.setEnergy(0)):w===null?(c.moveTo(h,d),c.setEnergy(0)):c.increaseEnergy()}e.isMultiSelectionMode()||e.updateActiveCursors(a?[a]:[])}getTargetAt(e,t,i){let r=null;for(const s of e.getTargets())s!==e.getDragTarget()&&s.contains(t,i,e.isLazySelect())&&(r=s);return r}}class ce{moveBy(e,t,i){const r=e.getClientWidth(),s=e.getClientHeight(),n=e.getActiveCursors(),u=Array.from(n);let a=u.length>0?u[0]:null;const g=e.getCursors().length===1;let c=null,h=Number.MAX_VALUE;for(const T of e.getCursors()){let C=T.getX()+t,A=T.getY()+i;g?(C=Math.max(0,Math.min(r,C)),A=Math.max(0,Math.min(s,A))):(C<0&&(C=r+C),A<0&&(A=s+A),C>r&&(C=C-r),A>s&&(A=A-s));let E=e.getTargets()[0]??null,Y=Number.MAX_VALUE;for(const I of e.getTargets()){const z=Math.hypot(C-I.getX(),A-I.getY());z<h?(c=T,E=I,h=Y=z):z<Y&&(E=I,Y=z)}if(E===null)continue;const k=Y-(e.getPreferences().sameSize?0:E.getRadius());T.setTarget(E),T.setTolerance(Math.max(k,.001)),a===null?(k<0&&(a=T),T.moveTo(C,A),T.setEnergy(0)):T===a?(k>0&&(a=null),T.moveTo(C,A),T.setEnergy(0)):k>0?(T.moveTo(C,A),T.setEnergy(0)):T.increaseEnergy()}if(a===null&&(a=c),a===null)return;const d=a.getTarget();if(d===null)return;let w=Math.hypot(a.getX()-d.getX(),a.getY()-d.getY())+d.getRadius();for(const T of e.getTargets())if(T!==d){const C=Math.hypot(a.getX()-T.getX(),a.getY()-T.getY())-T.getRadius();C<w&&(w=C)}if(e.getPreferences().sameSize)for(const T of e.getCursors())T.setTolerance(a.getTolerance());else a.setTolerance(w);a.setEnergy(0),e.updateActiveCursors([a])}}let P="NINJA_A";const y=new $,o=new ue(new D,y),v=document.getElementById("canvas"),f=v.getContext("2d");function V(){v.width=window.innerWidth,v.height=window.innerHeight,o.setBounds(v.width,v.height),o.resetCursors(),o.resetTargets(),b()}window.addEventListener("resize",V);let S=document.createElement("canvas"),q=S.getContext("2d"),p=document.createElement("canvas"),O=p.getContext("2d"),F=0,J=-1;function b(){F++}function U(){S.width=v.width,S.height=v.height,p.width=v.width,p.height=v.height,q.clearRect(0,0,S.width,S.height);for(const l of o.getTargets()){const e=l===o.getDragTarget();l.draw(q,o,!0,l.isLazy()||e)}O.clearRect(0,0,p.width,p.height),O.globalAlpha=.25,O.drawImage(S,0,0),O.globalAlpha=1,J=F}const m={x:0,y:0,radius:0};let X=null,M=0,Q=0,j=0,N=0,_=null;function ge(){return _||(_=new AudioContext),_}function R(l,e=.08){try{const t=ge(),i=t.createOscillator(),r=t.createGain();i.connect(r),r.connect(t.destination),i.frequency.value=l,r.gain.setValueAtTime(.15,t.currentTime),r.gain.exponentialRampToValueAtTime(.001,t.currentTime+e),i.start(),i.stop(t.currentTime+e)}catch{}}const he=[["SINGLE","1","Traditional Single Cursor"],["NINJA_A","2","Ninja Cursors (Waiting Queue)"],["NINJA_B","3","Ninja Cursors (Post-Selection)"],["BUBBLE","4","Bubbling Ninja Cursors"]];function fe(){const l=v.width,e=v.height,t=o.getTargets();if(f.clearRect(0,0,l,e),f.fillStyle="#fff",f.fillRect(0,0,l,e),y.targetCached){J!==F&&U();const s=o.getSingleActiveCursor();if(y.drawLayers&&s&&s.getTolerance()>0){const n=s.getX(),u=s.getY();if(N>2){for(const a of o.getCursors())if(a!==s){let g=((a.getX()-n)%l+l)%l,c=((a.getY()-u)%e+e)%e;for(const h of[g,g-l])for(const d of[c,c-e])f.drawImage(p,h,d)}}n!==Q||u!==j?N=Math.min(4,N+1):N=Math.max(0,N-1),Q=n,j=u}if(f.drawImage(S,0,0),o.isLazySelect()){f.fillStyle="rgba(0,0,0,0.5)",f.fillRect(0,0,l,e);for(const n of t)n.isLazy()&&n.draw(f,o,!1,n===o.getDragTarget())}else if(o.isMultiSelectionMode())for(const n of o.getActiveCursors()){const u=n.getTarget();u&&u.draw(f,o,!1,u===o.getDragTarget())}else if(s){const n=s.getTarget();n&&n.draw(f,o,!1,n===o.getDragTarget())}}else{for(const s of t)s.draw(f,o,!1,s===o.getDragTarget());if(o.isLazySelect()){f.fillStyle="rgba(0,0,0,0.5)",f.fillRect(0,0,l,e);for(const s of t)s.isLazy()&&s.draw(f,o,!1,s===o.getDragTarget())}}const i=o.getDragTarget();M>0?(M+=1,M>4&&(M=0,o.origin=null)):o.origin&&(M=1);for(const s of o.getCursors()){i&&(f.save(),f.translate(s.getX()-i.getX(),s.getY()-i.getY()),i.draw(f,o,!1,!0),f.restore());const n=o.origin;if(n&&M>0){const u=(4-M)/4;f.save(),f.translate(-(s.getX()-n.x)*u,-(s.getY()-n.y)*u),s.draw(f,o),f.restore()}else s.draw(f,o)}y.clickEffect&&m.radius>0&&(f.beginPath(),f.arc(m.x,m.y,m.radius,0,Math.PI*2),f.strokeStyle="rgba(255, 0, 0, 0.5)",f.lineWidth=4,f.stroke()),f.font="bold 15px Arial",f.fillStyle="#CC0000",f.fillText("Esc: Exit pointer lock",8,20);let r=40;for(const[s,n,u]of he)f.fillStyle=P===s?"#0000CC":"#666",f.fillText(`${n}: ${u}`,8,r),r+=18}setInterval(()=>{m.radius>de()+Te()?m.radius=0:m.radius>0&&(m.radius=Math.round(m.radius+Math.log(m.radius)*25))},100);function de(){return v.width}function Te(){return v.height}function K(){fe(),requestAnimationFrame(K)}function Ce(l,e){X!==null&&(o.setDragTarget(X),X=null),o.moveBy(l,e)}function ve(){if(o.getDragTarget()===null){if(o.getNumberOfActiveCursors()>1)o.setLazySelect(!0),R(440,.1);else{const l=o.getSingleActiveCursor();if(l!==null){const e=l.getTarget();e&&(m.x=e.getX(),m.y=e.getY(),m.radius=e.getRadius(),X=e,o.removeActiveCursor(l),R(660,.08))}o.setLazySelect(!1)}b()}}function ye(){if(X=null,o.getDragTarget()!==null){if(o.getNumberOfActiveCursors()>1)o.setLazySelect(!0),R(440,.1);else{const l=o.getSingleActiveCursor();if(l!==null){const e=l.getTarget();e&&(m.x=e.getX(),m.y=e.getY(),m.radius=e.getRadius(),o.removeTarget(o.getDragTarget()),o.setDragTarget(null),R(880,.08))}else o.setDragTarget(null);o.setLazySelect(!1)}b()}}let L=!1;v.addEventListener("mousemove",l=>{L&&Ce(l.movementX,l.movementY)});v.addEventListener("mousedown",()=>{L?ve():v.requestPointerLock()});v.addEventListener("mouseup",()=>{L&&ye()});document.addEventListener("pointerlockchange",()=>{L=document.pointerLockElement===v;const l=document.getElementById("overlay");l&&(l.style.display=L?"none":"flex")});document.addEventListener("pointerlockerror",()=>{console.error("Pointer lock failed")});document.addEventListener("keydown",l=>{switch(l.key){case"Escape":L&&document.exitPointerLock();break;case"1":o.setCursorManager(new D),y.drawPixels=!1,y.drawLayers=!1,y.cursorQueued=!0,o.setNumberOfCursors(1,1),o.resetCursors(),o.resetTargets(),P="SINGLE",b();break;case"2":o.setCursorManager(new D),y.drawPixels=!1,y.drawLayers=!1,y.cursorQueued=!0,o.setNumberOfCursors(2,2),o.resetCursors(),o.resetTargets(),P="NINJA_A",b();break;case"3":o.setCursorManager(new D),y.drawPixels=!1,y.drawLayers=!1,y.cursorQueued=!1,o.setNumberOfCursors(2,2),o.resetCursors(),o.resetTargets(),P="NINJA_B",b();break;case"4":o.setCursorManager(new ce),y.drawPixels=!0,y.drawLayers=!0,y.cursorQueued=!0,o.setNumberOfCursors(2,2),o.resetCursors(),o.resetTargets(),P="BUBBLE",b();break}});const H=document.getElementById("startBtn");H==null||H.addEventListener("click",()=>{v.requestPointerLock()});V();U();requestAnimationFrame(K);
