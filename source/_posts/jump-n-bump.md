---
title: Jump'n'bump
date: 2023-12-26
layout: post
tags: 
  - crazydev
---

*Мультиплеерная игрушка на php и javascript: SDL, devtools-protocol*

[Репозиторий](https://github.com/esix/jump-n-bump)

![Игра](./game-screen.png)

<!--more-->

Давно, когда веб развивался, JavaScript обрастал возможностями, PHP завоевывал мир, появлялись первые 
игры в браузере, а каждый юный разработчик, мечтал написать свою игрушку. С тех пор утекло много воды, php
потерял часть популярности, а JavaScript стал зрелым и развитым, но я все равно решил реализовать давнюю 
мечту, и написать на этих языках.

Для разнообразия я напишу клиента на PHP, а сервер на JavaScript

С нуля придумывать сбалансированный сюжет и геймплей тяжело, поэтому я буду портировать одну старую игрушку 
[Jump 'n Bump](https://en.wikipedia.org/wiki/Jump_%27n_Bump)

Есть прекрасный [порт на javascript](https://github.com/ennorehling/jump-n-bump) с которым я буду сверяться, но он
без мультиплеера. Хорошо реализована клиентская часть, но именно её я собираюсь писать на PHP. Так что придется 
построчно копировать и преобразовывать.


## Клиент

Начнем с клиентской части. Это графика, анимация, управление и звук (правда, звуки не
реализованы).

Возможностей рисовать окошки и графику на php не так уж много, но есть PHP-модуль [SDL](https://github.com/Ponup/php-sdl).

С серверной частью будет взаимодействовать через веб-сокеты.

### Установка

Модуль sdl-php на OSX с M1 через pecl не устанавливается, но легко собирается:

```
phpize
./configure 
make
```

Получившийся файл можно добавить в `php.ini`, либо указать при запуске
```
php -d "extension=./bin/sdl.so" ./jnb.php
```


Также потребуется парочка библиотек - `react/promise` для промисов и `ratchet/pawl` для работы с веб-сокетами. Их можно 
установить через
```
composer install
```





## Сервер

Сервер я буду писать на JavaScript. Проще всего было бы сделать это на Node.js, но, поскольку, JavaScript это 
браузерный язык, я предпочту писать серверную часть в браузере.


## Взаимодействие с сервером

Серверная часть запущена в браузере, а клиентская должна с ней взаимодействовать: получать координаты соперников и 
отправлять свои действия. 
